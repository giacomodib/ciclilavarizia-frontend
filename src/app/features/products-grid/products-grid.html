<mat-sidenav-container class="h-[calc(100vh-64px)] bg-gray-50">
    <mat-sidenav mode="side" opened class="w-72 border-r border-gray-200 bg-white shadow-sm">
        <div class="p-6 border-b border-gray-100 h-20 flex items-center">
            <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                <mat-icon class="text-red-600">category</mat-icon>
                Categories
            </h2>
        </div>
        <div class="py-2">
            <div class="px-5 mb-1">
                <mat-nav-list class="!pt-0 !pb-0">
                    <a mat-list-item [routerLink]="['/products/all']" [activated]="categoryValue() === 'all'"
                        class="!rounded-md !h-10 flex items-center hover:bg-gray-50 transition-colors">
                        <span matListItemTitle class="font-medium transition-colors !ml-6"
                            [class]="categoryValue() === 'all' ? '!text-white' : null">
                            All Products
                        </span>
                    </a>
                </mat-nav-list>
            </div>
            <mat-accordion multi="true" displayMode="flat">
                @for (group of categoryGroups(); track group.parent) {
                <mat-expansion-panel class="!rounded-none !shadow-none border-b border-gray-50 bg-transparent">
                    <mat-expansion-panel-header class="h-12 hover:bg-gray-50 px-6">
                        <mat-panel-title class="text-sm font-bold text-gray-700 uppercase tracking-wide">
                            {{ group.parent }}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-nav-list dense class="!pt-0">
                        @for (cat of group.categories; track cat.categoryId) {
                        <a mat-list-item [routerLink]="['/products', cat.categoryId]"
                            [activated]="categoryValue() === cat.categoryId.toString()" class="!pl-8 transition-colors">
                            <span matListItemTitle class="text-sm text-gray-600"
                                [class]="categoryValue() === cat.categoryId.toString() ? '!text-white' : null">
                                {{ cat.name }}
                            </span>
                        </a>
                        }
                    </mat-nav-list>

                </mat-expansion-panel>
                }
            </mat-accordion>
        </div>
    </mat-sidenav>
    <mat-sidenav-content class="bg-gray-50 p-8">
        <div class="flex justify-between items-end mb-8 border-b border-gray-200 pb-4">
            <div>
                <h1 class="text-3xl font-extrabold text-gray-900 capitalize tracking-tight">
                    {{ currentCategoryName() }}
                </h1>
                <p class="text-gray-500 mt-1 text-sm font-medium">
                    @if (isLoading()) {
                    Loading...
                    } @else {
                    <span class="text-red-600 font-bold">{{ totalItems() }}</span> products found
                    }
                </p>
            </div>
        </div>
        @if (isLoading()) {
        <div class="flex justify-center py-20">
            <mat-spinner diameter="40" color="warn"></mat-spinner>
        </div>
        }
        @if (!isLoading()) {
        <div class="responsive-grid">
            @for (product of products(); track product.productId) {
            <app-product-card [product]="product"></app-product-card>
            }
        </div>
        }
        @if (!isLoading() && products().length === 0) {
        <div class="text-center py-10 text-gray-500">No product found.</div>
        }
    </mat-sidenav-content>
</mat-sidenav-container>